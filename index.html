<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PıleySiteyşın 6 - Tablet Edition</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Saira:wght@300;500;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

        :root {
            --bg-dark: #050505;
            --china-red: #d32f2f;
            --fake-gold: #ffd700;
        }

        body {
            margin: 0; padding: 0; background-color: black; color: white;
            font-family: 'Saira', sans-serif; overflow: hidden; height: 100vh; width: 100vw;
            user-select: none; -webkit-user-select: none; touch-action: none; /* Mobilde kaydırmayı engelle */
        }

        /* DUVAR KAĞIDI & EFEKTLER */
        #bg-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: radial-gradient(circle at 50% 50%, #1a1a1a 0%, #000 90%);
        }
        .watermark {
            position: fixed; bottom: 120px; right: 10px; 
            font-family: Arial, sans-serif; font-size: 10px; color: #333; 
            font-weight: bold; pointer-events: none; z-index: 50;
        }

        /* FLASHBANG */
        .flash-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 99999; display: none;
            opacity: 1; transition: opacity 3s ease-out;
        }

        /* KURULUM EKRANI */
        .setup-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #111; z-index: 10000; display: flex; flex-direction: column;
            align-items: center; justify-content: center; border: 5px solid var(--china-red);
            padding: 20px; box-sizing: border-box;
        }
        .setup-input { margin: 10px; padding: 15px; width: 80%; max-width: 300px; background: #222; color: white; border: 1px solid #555; font-size: 1rem; }
        .setup-btn { background: var(--china-red); color: white; padding: 15px 40px; font-size: 1.2rem; cursor: pointer; border: none; font-weight: bold; margin-top: 20px; border-radius: 5px; }

        /* ANA ARAYÜZ */
        .top-bar {
            display: flex; justify-content: space-between; padding: 15px 20px; background: rgba(20,20,20,0.9); border-bottom: 2px solid #333;
            align-items: center;
        }
        .logo-text { font-size: 1.2rem; font-weight: bold; display: flex; align-items: center; gap: 5px; }
        
        .tabs { display: flex; gap: 15px; }
        .tab { padding: 5px 10px; color: #777; font-weight: bold; cursor: pointer; font-size: 0.9rem; }
        .tab.active { color: white; border-bottom: 3px solid var(--china-red); }

        .wifi-area { display: flex; align-items: center; font-size: 0.9rem; }
        .wifi-icon { margin-right: 5px; color: #444; }
        .wifi-icon.on { color: #0f0; text-shadow: 0 0 5px #0f0; }
        .wifi-icon.hacker { color: #0f0; text-shadow: 0 0 10px #0f0; animation: pulse 0.5s infinite; }

        @keyframes pulse { 0% { opacity: 0.5; } 100% { opacity: 1; } }

        /* KARTLAR */
        .scroll-wrapper {
            overflow: hidden; width: 100%; margin-top: 30px; height: 60vh; position: relative;
        }
        .card-container {
            display: flex; gap: 20px; padding-left: 50vw; /* Center start */
            transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        .card {
            min-width: 200px; height: 280px; background: #222; border-radius: 10px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border: 4px solid transparent; position: relative; flex-shrink: 0;
            transform: translateX(-50%); /* Center correction */
        }
        .card.selected { 
            transform: translateX(-50%) scale(1.1); 
            border-color: white; background: #333; z-index: 10; 
            box-shadow: 0 0 20px rgba(255,255,255,0.2); 
        }
        .card i { font-size: 4rem; margin-bottom: 20px; color: #888; }
        .card h2 { font-size: 1.2rem; text-align: center; padding: 0 10px; }

        /* APP PENCERELERİ (Responsive) */
        .app-window {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 5000; display: none; flex-direction: column; align-items: center; justify-content: center;
            padding: 20px; box-sizing: border-box;
        }

        /* NETFİLİZ */
        .netfiliz-bg { background: #000; color: #e50914; text-align: center; }
        .gihun-img { width: 80%; max-width: 300px; height: 300px; background: gray; margin-bottom: 20px; background-size: cover; border: 5px solid #222; margin: 0 auto 20px auto; }

        /* YUTUB */
        .yutub-bg { background: white; color: black; text-align: center; width: 95%; height: 60%; position: relative; border-radius: 10px; overflow: hidden; }
        .yutub-video { height: 70%; background: black; display: flex; align-items: center; justify-content: center; color: white; flex-direction: column; }

        /* BROWSER */
        .browser-frame { width: 95%; height: 80%; background: white; border-radius: 5px; overflow: hidden; display: flex; flex-direction: column; }
        .url-bar { background: #eee; padding: 10px; border-bottom: 1px solid #ccc; color: #333; font-family: monospace; display: flex; gap: 10px; align-items: center; font-size: 0.8rem; }
        .web-view { flex: 1; padding: 15px; color: black; font-family: sans-serif; overflow-y: auto; background: white; }
        .web-link { padding: 15px; margin: 5px 0; border: 1px solid #ddd; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-size: 0.9rem; }
        .web-link.hover { background: #e3f2fd; border-color: #2196f3; }

        /* GAME CANVAS (Responsive) */
        canvas { 
            background: #333; border: 2px solid white; image-rendering: pixelated; 
            max-width: 100%; height: auto; max-height: 60vh;
        }

        /* TOAST */
        .toast {
            position: fixed; top: 10px; left: 50%; transform: translateX(-50%); 
            background: #333; color: white; padding: 10px 20px; width: 80%; text-align: center;
            border-bottom: 3px solid var(--fake-gold); font-size: 1rem; display: none; z-index: 6000; border-radius: 5px;
        }

        /* --- SANAL KONTROLCÜ (TABLET İÇİN) --- */
        #virtual-controls {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 160px;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
            z-index: 8000; display: flex; justify-content: space-between; padding: 10px 30px; box-sizing: border-box;
            pointer-events: none; /* Arka planı tıklanabilir yap */
        }
        
        .dpad {
            position: relative; width: 140px; height: 140px; pointer-events: auto;
        }
        .dbtn {
            position: absolute; width: 45px; height: 45px; background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.3);
            border-radius: 8px; display: flex; justify-content: center; align-items: center; font-size: 1.5rem; color: rgba(255,255,255,0.7);
            cursor: pointer; -webkit-tap-highlight-color: transparent;
        }
        .dbtn:active { background: rgba(255,255,255,0.4); transform: scale(0.95); }
        .d-up { top: 0; left: 47.5px; }
        .d-down { bottom: 0; left: 47.5px; }
        .d-left { top: 47.5px; left: 0; }
        .d-right { top: 47.5px; right: 0; }

        .action-pad {
            display: flex; gap: 20px; align-items: center; pointer-events: auto;
        }
        .abtn {
            width: 60px; height: 60px; border-radius: 50%; background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3);
            color: white; font-weight: bold; display: flex; justify-content: center; align-items: center; cursor: pointer;
            font-size: 0.9rem; -webkit-tap-highlight-color: transparent;
        }
        .abtn:active { background: white; color: black; transform: scale(0.95); }
        .abtn.red { border-color: #d32f2f; color: #ff8a80; }
        .abtn.blue { border-color: #2196f3; color: #82b1ff; }
        .abtn.green { border-color: #4caf50; color: #b9f6ca; width: 70px; height: 70px; font-size: 1.2rem; }

        /* Tablet/Mobil Görünüm Ayarları */
        @media (max-width: 768px) {
            .top-bar { padding: 10px; }
            .logo-text i { font-size: 1rem; }
            .logo-text span { font-size: 1rem; }
            .tabs .tab { font-size: 0.7rem; padding: 5px; }
            .card { min-width: 160px; height: 220px; }
            .card i { font-size: 3rem; }
            .setup-box { width: 90%; }
        }

    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

    <div id="bg-layer"></div>
    <div class="watermark">Made in China | SONY© Değildir</div>
    <div class="flash-overlay" id="flashbang"></div>
    <div class="toast" id="toast-msg"></div>

    <!-- KURULUM -->
    <div class="setup-screen" id="setup">
        <h1 style="color: var(--china-red); text-align: center;">KURULUM SİHİRBAZI</h1>
        <p style="text-align:center; color: #aaa;">Tablet Sürümü V1.0</p>
        <input type="text" id="reg-name" class="setup-input" placeholder="Adınız">
        <button class="setup-btn" onclick="finishSetup()">KAYIT OL</button>
    </div>

    <!-- UI -->
    <div class="top-bar">
        <div class="logo-text">
            <i class="fab fa-playstation" style="color:red;"></i> 
            <span>PıleySiteyşın 6</span>
        </div>
        <div class="tabs">
            <div class="tab active" id="tab-games" onclick="switchTab('games')">OYUNLAR</div>
            <div class="tab" id="tab-media" onclick="switchTab('media')">MEDYA</div>
            <div class="tab" id="tab-web" onclick="switchTab('web')">WEB</div>
        </div>
        <div class="wifi-area">
            <i class="fas fa-wifi wifi-icon" id="wifi-icon" onclick="openWifiMenu()"></i>
            <span id="username-display">Misafir</span>
        </div>
    </div>

    <div class="scroll-wrapper">
        <div class="card-container" id="card-row"></div>
    </div>

    <!-- SANAL KONTROLCÜ -->
    <div id="virtual-controls">
        <div class="dpad">
            <div class="dbtn d-up" ontouchstart="simKey('ArrowUp')" onmousedown="simKey('ArrowUp')"><i class="fas fa-chevron-up"></i></div>
            <div class="dbtn d-down" ontouchstart="simKey('ArrowDown')" onmousedown="simKey('ArrowDown')"><i class="fas fa-chevron-down"></i></div>
            <div class="dbtn d-left" ontouchstart="simKey('ArrowLeft')" onmousedown="simKey('ArrowLeft')"><i class="fas fa-chevron-left"></i></div>
            <div class="dbtn d-right" ontouchstart="simKey('ArrowRight')" onmousedown="simKey('ArrowRight')"><i class="fas fa-chevron-right"></i></div>
        </div>
        <div class="action-pad">
            <div class="abtn blue" ontouchstart="simKey('i')" onmousedown="simKey('i')">WIFI</div>
            <div class="abtn red" ontouchstart="simKey('Escape')" onmousedown="simKey('Escape')">GERİ</div>
            <div class="abtn green" ontouchstart="simKey('Enter')" onmousedown="simKey('Enter')">SEÇ</div>
        </div>
    </div>

    <!-- === UYGULAMALAR === -->

    <!-- WIFI MENÜ -->
    <div class="app-window" id="app-wifi">
        <h1 style="color: #00a8ff;">AĞ SEÇİMİ</h1>
        <div style="background:#111; padding:20px; width:100%; max-width:400px; border:1px solid #333; text-align: left;">
            <div class="menu-item active" id="wifi-0">1. Ev İnterneti (ÇÖP)</div>
            <div class="menu-item" id="wifi-1">2. Komşunun WiFi (İDARE EDER)</div>
            <div class="menu-item" id="wifi-2">3. HACKER WIFI (GOD MODE)</div>
        </div>
        <p style="color: gray; margin-top: 20px;">Menü: Yön Tuşları • Seç: YEŞİL Buton</p>
    </div>

    <!-- SIPATIFAY -->
    <div class="app-window" id="app-spoti">
        <h1 style="color: #1db954;">SIPATIFAY</h1>
        <div style="background:#111; padding:20px; width:100%; max-width:400px; border:1px solid #333; text-align: left;">
            <div class="menu-item active" id="spoti-0">1. Damar Arabesk</div>
            <div class="menu-item" id="spoti-1">2. Mışıl Mışıl Uyku (TEHLİKELİ)</div>
        </div>
        <p id="spoti-status" style="color:yellow; margin-top:20px; height: 20px;"></p>
    </div>

    <!-- NETFİLİZ -->
    <div class="app-window netfiliz-bg" id="app-netfiliz">
        <h1 style="font-size: 2.5rem;">NETFİLİZ</h1>
        <div class="gihun-img" style="background-image: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRz-Mv9iWv6u4qH2pW7e1c2r9k8o5z_x5u_3w&s');"></div>
        <h3 style="margin-top:10px;">"BİZ İNSAN DEĞİLİZ..."</h3>
        <h3 style="color: yellow;">"...BİZ ATIZ!"</h3>
        <p>Çıkış: KIRMIZI Buton</p>
    </div>

    <!-- YUTUB -->
    <div class="app-window" id="app-yutub" style="background: #e1e1e1;">
        <div class="yutub-bg">
            <div class="yutub-video">
                <i class="fas fa-user-tie" style="font-size: 4rem; margin-bottom: 20px;"></i>
                <h3 id="yutub-text" style="padding: 0 10px;">DOLAR 100 TL OLACAK!</h3>
                <h4 style="color: red; animation: blink 0.5s infinite;">YTD YTD YTD</h4>
            </div>
            <h4 style="text-align:left; margin-left:20px; color:black;">Ekonomi Çok İyi (Yalan Haber)</h4>
        </div>
    </div>

    <!-- CHROME (BROWSER) -->
    <div class="app-window" id="app-browser">
        <div class="browser-frame">
            <div class="url-bar">
                <span id="url-text" style="flex:1;">chrome://new-tab</span>
                <i class="fas fa-sync"></i>
            </div>
            <div class="web-view" id="web-view">
                <!-- JS will fill this -->
            </div>
        </div>
    </div>

    <!-- MAĞAZA -->
    <div class="app-window" id="app-store">
        <h1 style="color:#00a8ff;">MAĞAZA</h1>
        <div id="store-grid" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; width: 100%; max-width: 500px;"></div>
    </div>

    <!-- OYUN: FIFA 77 -->
    <div class="app-window" id="game-fifa">
        <div style="position:absolute; top:10px; font-size:1rem; color:red; font-weight:bold; animation: blink 1s infinite; text-align: center; width: 100%;">
            GALATASARAY ŞİKE MODU AKTİF
        </div>
        <canvas id="fifa-canvas" width="600" height="400"></canvas>
        <p style="margin-top: 10px; font-size: 0.8rem;">Kontrol: Yön Tuşları</p>
    </div>

    <!-- OYUN: GTA -->
    <div class="app-window" id="game-gta">
        <div style="position:absolute; top:10px; font-size:1rem; color:white; font-weight:bold; text-shadow: 2px 2px red;">
            POLİS GELİYO KAÇ!
        </div>
        <canvas id="gta-canvas" width="400" height="500"></canvas>
        <p style="margin-top: 10px; font-size: 0.8rem;">Kontrol: Sol/Sağ Ok Tuşları</p>
    </div>

    <!-- OYUN: SİMİT SİMULATOR -->
    <div class="app-window" id="game-simit">
        <h1>SİMİT SİMULATOR</h1>
        <canvas id="simit-canvas" width="400" height="500"></canvas>
        <p style="margin-top: 10px; font-size: 0.8rem;">Kontrol: Sol/Sağ ile Yakala</p>
        <div id="simit-msg" style="color:red; display:none; position:absolute; font-size:1.5rem; text-align:center; background:black; padding: 10px; border: 2px solid red; z-index:10;">PUH SANA NİMETİ YERE DÜŞÜRDÜN!</div>
    </div>

    <script>
        /* --- STATE --- */
        let user = { name: "", games: [] };
        let state = { tab: 'games', idx: 0, screen: 'setup', wifi: 'none', app: null, subIdx: 0 };
        
        const apps = [
            { id: 'fifa', tab: 'games', title: 'FIFA 77', icon: 'fa-futbol', owned: true },
            { id: 'gta', tab: 'games', title: 'GTA Bağcılar', icon: 'fa-car', owned: true },
            { id: 'simit', tab: 'games', title: 'Simit Sim.', icon: 'fa-cookie', owned: false },
            { id: 'store', tab: 'games', title: 'Mağaza', icon: 'fa-shopping-cart', owned: true },
            { id: 'spoti', tab: 'media', title: 'Sıpatifay', icon: 'fa-spotify', owned: true },
            { id: 'netfiliz', tab: 'media', title: 'Netfiliz', icon: 'fa-play', owned: true },
            { id: 'yutub', tab: 'media', title: 'YuTub', icon: 'fa-youtube', owned: true },
            { id: 'browser', tab: 'web', title: 'Chrome', icon: 'fa-chrome', owned: true }
        ];

        /* --- TOUCH INPUT SIMULATOR --- */
        function simKey(keyName) {
            // Trigger logic directly based on key
            const e = { key: keyName, preventDefault: () => {} };
            
            if(state.screen === 'setup') return;

            // Global: WiFi Menu from button
            if((keyName === 'i' || keyName === 'I') && state.screen === 'home') {
                openWifiMenu();
                return;
            }

            if(state.screen === 'home') {
                if(keyName === 'ArrowRight') state.idx++;
                if(keyName === 'ArrowLeft') state.idx--;
                if(state.idx < 0) state.idx = 0;
                
                if(keyName === 'Enter') launchApp();
                
                renderHome();
            } 
            else if (state.screen === 'app') {
                if(keyName === 'Escape') closeApp();
                else handleAppInput(e);
            }
        }

        /* --- UI SWITCH TABS DIRECTLY --- */
        function switchTab(tabName) {
            if(state.screen !== 'home') return;
            state.tab = tabName;
            state.idx = 0;
            renderHome();
        }

        /* --- SETUP --- */
        function finishSetup() {
            let name = document.getElementById('reg-name').value;
            if(!name) name = "Gariban Tablet";
            user.name = name;
            document.getElementById('username-display').innerText = name;
            document.getElementById('setup').style.display = 'none';
            state.screen = 'home';
            renderHome();
        }

        /* --- RENDER HOME --- */
        function renderHome() {
            const container = document.getElementById('card-row');
            container.innerHTML = '';
            
            let items = apps.filter(a => a.tab === state.tab);

            items.forEach((item, i) => {
                let div = document.createElement('div');
                div.className = `card ${i === state.idx ? 'selected' : ''}`;
                // Tıklayınca açma desteği
                div.onclick = function() { 
                    if(state.idx === i) launchApp(); 
                    else { state.idx = i; renderHome(); }
                };
                
                let show = item.owned;
                if(item.id === 'simit' && !item.owned) show = false;
                if(item.id === 'store') show = true;

                if(show || item.tab !== 'games') {
                     div.innerHTML = `<i class="fas ${item.icon}"></i><h2>${item.title}</h2>`;
                     if(item.id === 'simit') div.innerHTML += `<small style="color:gold">YENİ!</small>`;
                     container.appendChild(div);
                } else {
                     div.style.display = 'none'; 
                }
            });

            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(`tab-${state.tab}`).classList.add('active');
            
            let w = document.getElementById('wifi-icon');
            w.className = "fas fa-wifi wifi-icon";
            if(state.wifi === 'home' || state.wifi === 'neighbor') w.classList.add('on');
            if(state.wifi === 'hacker') w.classList.add('hacker');
            
            // Responsive Scroll Centering logic
            // Base offset 220px, need to center active item
            // Using simpler logic for tablet: center current index
            // item width ~200px + gap 20px = 220px
            container.style.transform = `translateX(${state.idx * -220}px)`;
        }

        /* --- INPUT --- */
        document.addEventListener('keydown', (e) => {
            simKey(e.key);
        });

        /* --- LAUNCHER --- */
        function launchApp() {
            let items = apps.filter(a => a.tab === state.tab);
            if(state.tab === 'games') items = items.filter(i => i.owned || i.id === 'store');
            let app = items[state.idx];
            if(!app) return;

            // Internet Check
            if(['netfiliz', 'yutub', 'browser', 'store'].includes(app.id) && state.wifi === 'none') {
                showToast("HATA: İnternet Yok! [WIFI] butonuna bas.");
                return;
            }

            state.screen = 'app';
            state.app = app.id;
            state.subIdx = 0;
            
            document.querySelectorAll('.app-window').forEach(d => d.style.display = 'none');

            if(app.id === 'spoti') {
                document.getElementById('app-spoti').style.display = 'flex';
                updateSpotiUI();
            }
            else if(app.id === 'netfiliz') document.getElementById('app-netfiliz').style.display = 'flex';
            else if(app.id === 'yutub') document.getElementById('app-yutub').style.display = 'flex';
            else if(app.id === 'store') {
                document.getElementById('app-store').style.display = 'flex';
                renderStore();
            }
            else if(app.id === 'browser') {
                document.getElementById('app-browser').style.display = 'flex';
                renderBrowser();
            }
            else if(app.id === 'fifa') {
                document.getElementById('game-fifa').style.display = 'flex';
                startFIFA();
            }
            else if(app.id === 'simit') {
                 document.getElementById('game-simit').style.display = 'flex';
                 startSimit();
            }
            else if(app.id === 'gta') {
                document.getElementById('game-gta').style.display = 'flex';
                startGTA();
            }
        }

        function closeApp() {
            state.screen = 'home';
            document.querySelectorAll('.app-window').forEach(d => d.style.display = 'none');
            stopGameLoops();
            renderHome();
        }

        /* --- WIFI LOGIC --- */
        function openWifiMenu() {
            if(state.screen === 'setup') return;
            state.screen = 'app';
            state.app = 'wifi';
            state.subIdx = 0;
            document.getElementById('app-wifi').style.display = 'flex';
            updateWifiUI();
        }

        function updateWifiUI() {
             let opts = document.querySelectorAll('#app-wifi .menu-item');
             opts.forEach((o, i) => o.style.color = state.subIdx === i ? 'white' : '#555');
        }

        /* --- BROWSER LOGIC --- */
        const websites = [
            { name: "Google", url: "www.google.com", type: "search" },
            { name: "Twitter (X)", url: "www.twitter.com", type: "jail" },
            { name: "Simit Borsası", url: "www.simit.net", type: "content" },
            { name: "Deep Web", url: "66.254.12.1", type: "hacker" },
            { name: "YouTube", url: "www.youtube.com", type: "redirect" }
        ];

        function renderBrowser() {
            const view = document.getElementById('web-view');
            view.innerHTML = `<h3>Sık Kullanılanlar</h3>`;
            websites.forEach((site, i) => {
                let div = document.createElement('div');
                div.className = `web-link ${state.subIdx === i ? 'hover' : ''}`;
                // Tıklanabilir yapalım
                div.onclick = function() { visitSite(site); };
                
                div.innerHTML = `<span>${site.name}</span> <small>${site.url}</small>`;
                view.appendChild(div);
            });
            document.getElementById('url-text').innerText = "chrome://new-tab";
        }

        function visitSite(site) {
             const view = document.getElementById('web-view');
             document.getElementById('url-text').innerText = site.url;
             
             if(site.type === "jail") {
                 view.innerHTML = `
                    <div style="text-align:center; margin-top:20px;">
                        <i class="fas fa-dungeon" style="font-size:4rem; color:#555;"></i>
                        <h2 style="color:red;">SİLİVRİ SOĞUKTUR...</h2>
                        <p>Erişim Engellendi.</p>
                    </div>`;
             } else if(site.type === "search") {
                 view.innerHTML = `<h2 style="color:blue">Goggle</h2><input type="text" placeholder="Ara..." style="padding:10px; width:80%;">`;
             } else if(site.type === "content") {
                 view.innerHTML = `<h2>Simit Borsası</h2><p>Simit: 15 TL</p><p>Çay: 10 TL</p><p style="color:green">Hisseler yükselişte!</p>`;
             } else if(site.type === "hacker") {
                 view.innerHTML = `<h2 style="color:#0f0; font-family:monospace;">HACKER ZONE</h2><p>Komşu WiFi Şifresi: 123456</p>`;
             } else if(site.type === "redirect") {
                 view.innerHTML = `<h2>Yönlendiriliyor...</h2>`;
                 setTimeout(() => { closeApp(); }, 1000);
             }
        }

        /* --- APP INPUT HANDLING --- */
        function handleAppInput(e) {
            // WIFI
            if(state.app === 'wifi') {
                if(e.key === 'ArrowDown') state.subIdx = (state.subIdx + 1) % 3;
                if(e.key === 'ArrowUp') state.subIdx = (state.subIdx - 1 + 3) % 3;
                updateWifiUI();
                if(e.key === 'Enter') {
                    if(state.subIdx === 0) state.wifi = 'home';
                    if(state.subIdx === 1) state.wifi = 'neighbor';
                    if(state.subIdx === 2) state.wifi = 'hacker';
                    closeApp();
                    showToast("Ağ Bağlandı: " + state.wifi.toUpperCase());
                }
            }

            // SPOTI
            if(state.app === 'spoti') {
                if(e.key === 'ArrowDown' || e.key === 'ArrowUp') { state.subIdx = state.subIdx === 0 ? 1 : 0; updateSpotiUI(); }
                if(e.key === 'Enter') {
                    if(state.subIdx === 1) { // Flashbang
                        document.getElementById('spoti-status').innerText = "Yükleniyor...";
                        setTimeout(() => {
                            let fb = document.getElementById('flashbang');
                            fb.style.display = 'block';
                            fb.style.opacity = '1';
                            setTimeout(() => { fb.style.opacity = '0'; }, 500);
                            setTimeout(() => { fb.style.display = 'none'; }, 3500);
                        }, 2000);
                    } else {
                         document.getElementById('spoti-status').innerText = "Müslüm Baba Çalıyor...";
                    }
                }
            }
            
            // BROWSER
            if(state.app === 'browser') {
                let max = websites.length;
                if(e.key === 'ArrowDown') { state.subIdx = (state.subIdx + 1) % max; renderBrowser(); }
                if(e.key === 'ArrowUp') { state.subIdx = (state.subIdx - 1 + max) % max; renderBrowser(); }
                if(e.key === 'Enter') visitSite(websites[state.subIdx]);
            }
            
            // STORE
            if(state.app === 'store') {
                if(e.key === 'ArrowRight') state.subIdx = 1;
                if(e.key === 'ArrowLeft') state.subIdx = 0;
                if(e.key === 'Enter') {
                    if(state.subIdx === 0) {
                        let g = apps.find(a => a.id === 'simit');
                        g.owned = true;
                        showToast("Simit Simulator İndirildi!");
                    } else {
                        showToast("Paran Yetersiz!");
                    }
                    renderStore();
                }
            }

            // GAMES
            if(state.app === 'simit') {
                if(e.key === 'ArrowLeft') playerX -= 20;
                if(e.key === 'ArrowRight') playerX += 20;
            }
            if(state.app === 'gta') {
                if(e.key === 'ArrowLeft') gtaX -= 15;
                if(e.key === 'ArrowRight') gtaX += 15;
            }
            // FIFA - Sadece kaleci yönlendirme (Şike var zaten)
        }

        /* --- UI HELPERS --- */
        function updateSpotiUI() {
            let opts = document.querySelectorAll('#app-spoti .menu-item');
            opts.forEach((o, i) => o.style.color = state.subIdx === i ? 'white' : '#555');
        }
        function renderStore() {
            let grid = document.getElementById('store-grid');
            grid.innerHTML = '';
            let items = [ {id: 'simit', name: 'Simit Sim', price: 'BEDAVA'}, {id: 'halay', name: 'Halay VR', price: '50 TL'} ];
            items.forEach((it, i) => {
                let div = document.createElement('div');
                div.style.background = '#222'; div.style.padding = '15px';
                div.style.border = state.subIdx === i ? '2px solid white' : '2px solid transparent';
                // Dokunmatik seçimi için
                div.onclick = function() { 
                    if(state.subIdx === i) {
                        // Buy logic duplicate
                        if(i===0) { apps.find(a=>a.id==='simit').owned=true; showToast("İndirildi!"); }
                        else showToast("Para Yok!");
                        renderStore();
                    } else {
                        state.subIdx = i; renderStore();
                    }
                };
                
                div.innerHTML = `<h3>${it.name}</h3><p>${it.price}</p>`;
                if(it.id === 'simit' && apps.find(a=>a.id==='simit').owned) div.innerHTML += "<b style='color:green'>ALINDI</b>";
                grid.appendChild(div);
            });
        }
        function showToast(msg) {
            let t = document.getElementById('toast-msg');
            t.innerText = msg; t.style.display = 'block';
            setTimeout(() => t.style.display = 'none', 2000);
        }

        /* --- GAMES LOOPS --- */
        let gameInterval;
        let playerX = 180; // Simit player
        let gtaX = 180; // GTA player
        let gtaPoliceY = 400;
        let gtaBullets = [];

        function stopGameLoops() { clearInterval(gameInterval); }

        // FIFA
        function startFIFA() {
            let cvs = document.getElementById('fifa-canvas');
            let ctx = cvs.getContext('2d');
            let ball = {x: 300, y: 200, dx: 5, dy: 5};
            gameInterval = setInterval(() => {
                ctx.fillStyle = "green"; ctx.fillRect(0,0,600,400);
                ctx.strokeStyle = "white"; ctx.strokeRect(50,50,500,300);
                ctx.beginPath(); ctx.arc(300,200,50,0,Math.PI*2); ctx.stroke();
                ctx.fillStyle = "white"; ctx.beginPath(); ctx.arc(ball.x, ball.y, 10, 0, Math.PI*2); ctx.fill();
                ball.x += ball.dx; ball.y += ball.dy;
                if(ball.y < 0 || ball.y > 400) ball.dy *= -1;
                if(ball.x > 600 || ball.x < 0) { ball.x = 300; ball.y = 200; }
                ctx.fillStyle = "yellow"; ctx.font = "20px Arial"; ctx.fillText("GALATASARAY: 5 - RAKİP: 0", 150, 30);
            }, 30);
        }

        // SİMİT
        function startSimit() {
            let cvs = document.getElementById('simit-canvas');
            let ctx = cvs.getContext('2d');
            let objects = [];
            let score = 0;
            let msg = document.getElementById('simit-msg');
            msg.style.display = 'none';

            gameInterval = setInterval(() => {
                ctx.fillStyle = "#87CEEB"; ctx.fillRect(0,0,400,500);
                ctx.fillStyle = "white"; ctx.fillRect(playerX, 450, 40, 20); // Martı
                
                if(Math.random() < 0.05) objects.push({x: Math.random()*380, y: 0});
                
                objects.forEach((o, i) => {
                    o.y += 5;
                    ctx.fillStyle = "orange"; ctx.beginPath(); ctx.arc(o.x, o.y, 10, 0, Math.PI*2); ctx.fill();
                    
                    if(o.y > 500) { 
                        objects.splice(i, 1);
                        msg.style.display = 'block';
                        score -= 5;
                        setTimeout(() => msg.style.display = 'none', 1000);
                    }
                    if(Math.abs(o.x - playerX) < 30 && o.y > 440) {
                        score++; objects.splice(i, 1);
                    }
                });
                ctx.fillStyle = "black"; ctx.font = "20px Arial"; ctx.fillText("Puan: " + score, 10, 30);
            }, 30);
        }

        // GTA
        function startGTA() {
            let cvs = document.getElementById('gta-canvas');
            let ctx = cvs.getContext('2d');
            gtaX = 180;
            gtaBullets = [];
            
            gameInterval = setInterval(() => {
                ctx.fillStyle = "#333"; ctx.fillRect(0,0,400,500); // Yol
                ctx.fillStyle = "white"; ctx.fillRect(195, 0, 10, 500); // Şerit
                
                // Polis (Arkada)
                gtaPoliceY = 400 + Math.sin(Date.now() / 200) * 10; 
                ctx.fillStyle = "blue"; ctx.fillRect(gtaX, gtaPoliceY, 40, 60);
                if(Date.now() % 200 < 100) ctx.fillStyle = "red"; else ctx.fillStyle = "blue"; 
                ctx.fillRect(gtaX, gtaPoliceY, 40, 5); // Siren

                // Oyuncu (Önde)
                ctx.fillStyle = "red"; ctx.fillRect(gtaX, 300, 40, 60); // Tofaş

                // Mermiler (Yanlardan)
                if(Math.random() < 0.1) {
                    let side = Math.random() < 0.5 ? 0 : 400;
                    gtaBullets.push({ x: side, y: Math.random() * 400, dx: side === 0 ? 5 : -5 });
                }

                ctx.fillStyle = "yellow";
                gtaBullets.forEach((b, i) => {
                    b.x += b.dx;
                    ctx.beginPath(); ctx.arc(b.x, b.y, 3, 0, Math.PI*2); ctx.fill();
                    if(b.x < 0 || b.x > 400) gtaBullets.splice(i, 1);
                });

                ctx.fillStyle = "white"; ctx.font = "20px Arial"; ctx.fillText("POLİSTEN KAÇ!", 10, 30);
            }, 30);
        }

        /* --- BLINK ANIMATION --- */
        const styleSheet = document.createElement("style");
        styleSheet.innerText = `
            @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
            .menu-item { padding: 10px; color: #555; cursor: pointer; }
            .menu-item.active { background: #333; color: white; border-left: 5px solid green; }
        `;
        document.head.appendChild(styleSheet);

        renderHome();
    </script>
</body>
</html>
